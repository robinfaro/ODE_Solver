<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ODE Solver: ODE Solver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ODE Solver<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Developed by Maddalena Detti and Robin Faro</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ODE Solver </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Optimized Render of the Equations</h1>
<p>This file contains equations that are designed to be displayed on the main page of the Doxygen documentation, accessible through the <code>index.html</code> file in the documentation folder. To ensure proper rendering, the equations are formatted using LaTeX syntax. Make sure that the documentation environment supports MathJax or a similar LaTeX rendering tool for the best visual presentation.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Setup Instructions</h1>
<p>Follow these steps to set up and run the project:</p>
<h2><a class="anchor" id="autotoc_md3"></a>
1. Clone the Repository</h2>
<p>Clone the repository to your local machine and open a terminal inside the cloned directory: </p><div class="fragment"><div class="line">git clone https://github.com/robinfaro/ODE_Solver.git</div>
<div class="line">cd ODE_Solver</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4"></a>
2. Populate Submodules</h2>
<p>Initialize the required submodules (<code>eigen</code> and <code>gtest</code>) using the following commands: </p><div class="fragment"><div class="line">git submodule update --init eigen</div>
<div class="line">git submodule update --init gtest</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5"></a>
3. Set Up CMake Compilation</h2>
<p>Create a <code>build</code> directory, configure the build system with CMake and compile the project: </p><div class="fragment"><div class="line">mkdir build</div>
<div class="line">cd build</div>
<div class="line">cmake ..</div>
<div class="line">cmake --build .</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6"></a>
4. Run Tests</h2>
<p>To verify the setup, run the tests: </p><div class="fragment"><div class="line">./ODE_Solver_Tests</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
5. Run the Program</h2>
<p>You can run the program by passing an input file as a parameter. For example: </p><div class="fragment"><div class="line">./ODE_Solver &lt;input_file&gt;</div>
</div><!-- fragment --><p> This will allow you to solve a system of differential equations with your desired methods and parameters. It will print the numerical approximation of the solution at each time step.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md9"></a>
Example System</h2>
<p>We provide 10 methods to solve Vectorial ODEs, assuming the system is in the form:     </p><p class="formulaDsp">
\[
\frac{dy_1}{dt} = f_1(y_1, ..., y_n, t)\\
\vdots\\
\frac{dy_n}{dt} = f_n(y_1, ..., y_n, t)
\]
</p>
<p>Each \(f_i(y_1, ..., y_n, t)\) is a combination of basic mathematical functions f. For example:   </p><p class="formulaDsp">
\[
f_i(y_1, ..., y_n, t) = m_t \text{f}_t(t) + m_j \text{f}_j(y_1) +  \ldots + m_k\text{f}_k(y_n)
\]
</p>
<hr  />
<h2><a class="anchor" id="autotoc_md11"></a>
Available Basic Functions</h2>
<p>The following basic mathematical functions can be used to construct the system:</p>
<ol type="1">
<li><b>Sine function:</b> <p class="formulaDsp">
\[ \text{f1}(x, \text{param}) = \sin(\text{param} \cdot x) \]
</p>
</li>
<li><b>Cosine function:</b> <p class="formulaDsp">
\[ \text{f2}(x, \text{param}) = \cos(\text{param} \cdot x) \]
</p>
</li>
<li><b>Exponential function:</b> <p class="formulaDsp">
\[ \text{f3}(x, \text{param}) = e^{\text{param} \cdot x} \]
</p>
</li>
<li><b>Power function:</b> <p class="formulaDsp">
\[ \text{f4}(x, \text{param}) = x^{\text{param}} \]
</p>
</li>
<li><b>Logarithmic function:</b> <p class="formulaDsp">
\[ \text{f5}(x, \text{param}) = \log(\text{param} \cdot x) \]
</p>
</li>
<li><b>Identity function:</b> <p class="formulaDsp">
\[ \text{f6}(x, \text{param}) = \text{param} \cdot x \]
</p>
</li>
<li><b>Constant function:</b> <p class="formulaDsp">
\[ \text{f7}(x, \text{param}) = \text{param} \]
</p>
</li>
</ol>
<p>Each function is combined within the system equations using a multiplier and parameter, following the format specified in the input file.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md13"></a>
Available Methods</h2>
<p>The available numerical methods and their corresponding method numbers are as follows:</p>
<ol type="1">
<li><b>Forward Euler (<a class="el" href="class_forward_euler.html" title="A class for solving ordinary differential equations (ODEs) using the Forward Euler method.">ForwardEuler</a>):</b> No additional parameters needed.</li>
<li><b>Adam-Bashforth One-Step (<a class="el" href="class_adam_bashforth_one_step.html" title="A class for solving ordinary differential equations (ODEs) using the Adams-Bashforth one-step method.">AdamBashforthOneStep</a>):</b> No additional parameters needed.</li>
<li><b>Adam-Bashforth Two-Steps (<a class="el" href="class_adam_bashforth_two_steps.html" title="A class for solving ordinary differential equations (ODEs) using the Adams-Bashforth two-step method.">AdamBashforthTwoSteps</a>):</b> No additional parameters needed.</li>
<li><b>Adam-Bashforth Three-Steps (<a class="el" href="class_adam_bashforth_three_steps.html" title="A class for solving ordinary differential equations (ODEs) using the Adams-Bashforth three-step metho...">AdamBashforthThreeSteps</a>):</b> No additional parameters needed.</li>
<li><b>Adam-Bashforth Four-Steps (<a class="el" href="class_adam_bashforth_four_steps.html" title="A class for solving ordinary differential equations (ODEs) using the Adams-Bashforth four-step method...">AdamBashforthFourSteps</a>):</b> No additional parameters needed.</li>
<li><b>Backward Euler (<a class="el" href="class_backward_euler.html" title="A class for solving ordinary differential equations (ODEs) using the Backward Euler method.">BackwardEuler</a>):</b> Requires the Jacobian of the system to be provided.</li>
<li><b>Runge-Kutta Explicit (<a class="el" href="class_runge_kutta.html" title="A class for solving ordinary differential equations (ODEs) using the Runge-Kutta method.">RungeKutta</a>):</b> Requires matrix A, vector b, and vector c. Matrix A must be lower triangular.</li>
<li><b>Backward Differentiation Formula (<a class="el" href="class_b_d_f.html" title="A class for solving ordinary differential equations (ODEs) using the Backward Differentiation Formula...">BDF</a>):</b> Requires the Jacobian of the system and vector alpha.</li>
<li><b>Adam-Moulton (<a class="el" href="class_adam_moulton.html" title="A class for solving ordinary differential equations (ODEs) using the Adams-Moulton method.">AdamMoulton</a>):</b> Requires the Jacobian of the system and vector beta.</li>
<li><b>Adam-Bashforth (<a class="el" href="class_adam_bashforth.html" title="A class for solving ordinary differential equations (ODEs) using the Adams-Bashforth method.">AdamBashforth</a>):</b> Requires vector beta.</li>
</ol>
<hr  />
<h2><a class="anchor" id="autotoc_md15"></a>
Input File Format</h2>
<p>The input file must be a <b>txt</b> structured as follows:</p>
<div class="fragment"><div class="line">Number of equations: </div>
<div class="line">Function combination: </div>
<div class="line">Derivative combination: NA</div>
<div class="line">Method: </div>
<div class="line">Initial Time: </div>
<div class="line">Final Time: </div>
<div class="line">Step Size: </div>
<div class="line">Number of Steps: </div>
<div class="line">Initial Condition: </div>
<div class="line">Number of Stages: </div>
<div class="line">A: NA</div>
<div class="line">B: NA</div>
<div class="line">C: NA</div>
<div class="line">Alpha: NA</div>
<div class="line">Beta: NA</div>
</div><!-- fragment --><p>This format ensures all keys are present, even if no values are provided. If a value is not provided, use <code>NA</code> to signify it is not applicable.</p>
<h3><a class="anchor" id="autotoc_md16"></a>
Explanation of Entries:</h3>
<ul>
<li>\(\textbf{Number of equations}\): Number of ODEs in the system.</li>
<li>\(\textbf{Function combination}\): Defines the function matrix for \(f(t, y_1, ..., y_n)\). Each row corresponds to one equation in the system, each entry in a row defines the contribution of a specific variable ( \(y_i\)) or the time variable ( \(t\)) in that equation. Entries follow the format <code>multiplier_functionNumber_parameter</code> or <code>0</code> if the corresponding variable ( \(t\) or \(y_i\)) does not contribute to that row. The value of functionNumber has to follow the list of available mathematical functions above. Multiplier and parameter are two signed floating point values.</li>
<li>\(\textbf{Derivative combination}\): Defines the Jacobian matrix (if needed). Each row corresponds to one equation in the system and entries follow the same format as the function combination.</li>
<li>\(\textbf{Method}\): Specifies the numerical method to use (see the method list above).</li>
<li>\(\textbf{Initial Time}\): The starting time for the simulation.</li>
<li>\(\textbf{Final Time}\) The ending time for the simulation.</li>
<li>\(\textbf{Step Size}\): The time step for the simulation.</li>
<li>\(\textbf{Number of Steps}\) Number of steps of the method.</li>
<li>\(\textbf{Initial Condition}\): Each row represents the values of \(y_1, ..., y_n\) at a given time step. For example, if there are three initial conditions provided, the user will pass three rows, each containing the values for all variables in the system.</li>
<li>\(\textbf{Number of Stages, A, B, C, Alpha and Beta}\): Parameters for specific methods (e.g. RK and AM). For the Runge-Kutta method, the matrix A is provided by rows and the vectors B and C are listed as single-line entries. The A matrix must be lower triangular for explicit methods.</li>
</ul>
<h3><a class="anchor" id="autotoc_md17"></a>
Note on Parsing:</h3>
<ul>
<li>Each input parameter begins with a <b>key</b> (e.g., <code>Number of equations:</code>, <code>Derivative combination:</code>).</li>
<li>The system will continue parsing subsequent lines as part of the current parameter until another key is encountered.</li>
<li>This format allows multi-line entries for parameters such as <code>Function/Derivative combination</code>, <code>Initial Condition</code>, and matrix <code>A</code>.</li>
<li>Input matrices and vectors can contain numerical values in either decimal floating-point format or fractional representation.</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md19"></a>
Notes on Function Matrix</h2>
<p>The first entry of each row in the function matrix refers to the time variable ( \(t\)). Ensure that \(t\) is appropriately included as the first parameter in all equations.</p>
<hr  />
<h2><a class="anchor" id="autotoc_md21"></a>
Example Input File</h2>
<p>Here is an example input file for the system:     </p><p class="formulaDsp">
\[
\frac{dy_1}{dt} = t + y_2\\

\frac{dy_2}{dt} = \sin(t) - y_1
\]
</p>
<div class="fragment"><div class="line">Number of equations: 2</div>
<div class="line">Function combination: +1_6_1 0 1_6_1</div>
<div class="line">1_1_1 -1_6_1 0</div>
<div class="line">Derivative combination: 0 1_7_1</div>
<div class="line">-1_7_1 0</div>
<div class="line">Method: 1</div>
<div class="line">Initial Time: 0.0</div>
<div class="line">Final Time: 1.0</div>
<div class="line">Step Size: 0.1</div>
<div class="line">Number of Steps: 3</div>
<div class="line">Initial Condition: 1 0</div>
<div class="line">1 -0.1</div>
<div class="line">1 -0.19</div>
<div class="line">Number of Stages: 1</div>
<div class="line">A: NA</div>
<div class="line">B: NA</div>
<div class="line">C: NA</div>
<div class="line">Alpha: NA</div>
<div class="line">Beta: NA</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md22"></a>
Tests</h1>
<p>As said above we provide several tests for our methods, in particular we test all the implemented methods both with a scalar and a vectorial ODE, by comparing each method's output with the approximations of a third-party solver with a tolerance of \(10^{-4}\).</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Note on methods with no specific implemenation</h2>
<p>For the methods with no specified version to implement, we tested the following ones:</p><ul>
<li>RK4 for Runge Kutta family.</li>
<li>AM3 for Adam Moulton family.</li>
<li>BDF1 for Backward Differentiation Formula family.</li>
</ul>
<h2><a class="anchor" id="autotoc_md24"></a>
1. Scalar Test</h2>
<p>We consider the ODE:   </p><p class="formulaDsp">
\[
\frac{dy}{dt} = e^{-t} + cos(y)\\
\]
</p>
<p> where we set:</p><ul>
<li>Initial Time: 0.0</li>
<li>Final Time: 2.0</li>
<li>Step Size: 0.1 </li>
</ul>
<h3><a class="anchor" id="autotoc_md25"></a>
Initial Conditions</h3>
<ul>
<li>For 1 step method we use \(y(0) = 0.0\) as inital condition.</li>
<li>For 2 step methods we use \(y(0) = 0.0, y(0.1) = 0.2\) as initial condition.</li>
<li>For 3 step methods we use \(y(0) = 0.0, y(0.1) = 0.2, y(0.2)=0.3884\) as initial condition.</li>
<li>For 4 step methods we use \(y(0) = 0.0, y(0.1) = 0.2, y(0.2)=0.3884, y(0.3)=0.5629\) as initial condition.</li>
</ul>
<h2><a class="anchor" id="autotoc_md26"></a>
2. Vectorial Test</h2>
<p>We consider the ODE:    </p><p class="formulaDsp">
\[
\frac{dy_1}{dt} = t + y_2\\
\frac{dy_2}{dt} = \sin(t) - y_1
\]
</p>
<p> where we set:</p><ul>
<li>Initial Time: 0.0</li>
<li>Final Time: 1.0</li>
<li>Step Size: 0.1 </li>
</ul>
<h3><a class="anchor" id="autotoc_md27"></a>
Initial Conditions</h3>
<ul>
<li>For 1 step method we set \(\vec{y}(0) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ 0.0 \\  \end{bmatrix} \)</li>
<li>For 2 step method we set \(\vec{y}(0) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ 0.0 \\  \end{bmatrix}  \) and \(\vec{y}(0.1) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ -0.1 \\  \end{bmatrix}  \)</li>
<li>For 3 step method we set \(\vec{y}(0) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ 0.0 \\  \end{bmatrix}  \) and \(\vec{y}(0.1) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ -0.1 \\  \end{bmatrix}  \) and \(\vec{y}(0.2) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ -0.19 \\  \end{bmatrix}  \)</li>
<li>For 4 step method we set \(\vec{y}(0) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ 0.0 \\  \end{bmatrix}  \) and \(\vec{y}(0.1) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ -0.1 \\  \end{bmatrix}  \) and \(\vec{y}(0.2) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ -0.19 \\  \end{bmatrix}  \) and \(\vec{y}(0.3) \) = \(\begin{bmatrix}  y_1\\ y_2 \\  \end{bmatrix} \) = \(\begin{bmatrix}  1.0\\ -0.27 \\  \end{bmatrix}  \)</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
Modify Test Systems Parameters</h2>
<p>To customize the parameters of the test systems, you can use the input files provided in the <code>input_examples</code> folder. This folder contains example configurations for both scalar and vector ODE systems. You can edit these files to change parameters or specify different numerical methods.</p>
<h3><a class="anchor" id="autotoc_md29"></a>
Example Input Files:</h3>
<ol type="1">
<li><b><code>input_file_vector_ODE.txt</code></b> <br  />
<ul>
<li>This file is pre-configured with parameters for the <b>Adam-Moulton 3-step (AM3)</b> method. <br  />
</li>
<li>Modify this file to adjust the vector ODE system or to experiment with other methods.</li>
</ul>
</li>
<li><b><code>input_file_scalar_ODE.txt</code></b> <br  />
<ul>
<li>This file is pre-configured with parameters for the <b>Adam-Bashforth 2-step (AB2)</b> method. <br  />
</li>
<li>Use this file to tweak the scalar ODE system or test additional configurations.</li>
</ul>
</li>
</ol>
<p>Simply open the relevant input file, edit the parameters as needed, and pass the file to the program as an argument: </p><div class="fragment"><div class="line">./ODE_Solver &lt;input_file&gt;</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md30"></a>
Empty Skeleton for New Configurations:</h3>
<p>We also provide an empty skeleton file, <b><code>empty_input_file.txt</code></b>, where you can define your own parameters for a completely custom setup.</p>
<h1><a class="anchor" id="autotoc_md31"></a>
Coding Convention</h1>
<p>We follow the <b>Google C++ Style Guide</b> coding convenction for our project. You can find the full guidelines <a href="https://google.github.io/styleguide/cppguide.html">here</a>.</p>
<h2><a class="anchor" id="autotoc_md32"></a>
Key Conventions Used:</h2>
<ol type="1">
<li><b>Variable naming:</b><ul>
<li>Variables are written in lowercase, with words separated by underscores.</li>
<li>Example: <code>variable_name</code>, <code>matrix_size</code>.</li>
</ul>
</li>
<li><b>Class and function naming:</b><ul>
<li>Classes and functions start with an uppercase letter, with subsequent words also capitalized (CamelCase).</li>
<li>Example: <code>ClassName</code>, <code>FunctionName</code>.</li>
</ul>
</li>
<li><b>Consistency with Google Style Guide:</b><ul>
<li>The overall structure, indentation, and formatting of the code align with the Google Style Guide recommendations.</li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="autotoc_md33"></a>
TODOs and future works</h1>
<ol type="1">
<li><b>Extend RK methods:</b> Add support for implicit Runge-Kutta methods.</li>
<li><b>Advanced function combinations:</b> Allow more advanced functions, complex combinations, function of functions and the multiplication between different variables.</li>
<li><b>Parsing fraction as multiplier and parameters for the input function:</b> Enable the interpretation of fractions as multipliers and as parameters for input functions.</li>
<li><b>Plotting for scalar equations:</b> Provide functions to visualize scalar solutions.</li>
<li><b>Stability checks:</b> Implement stability checks for explicit methods to prevent non-converging approximations.</li>
</ol>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
